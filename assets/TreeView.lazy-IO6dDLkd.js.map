{"version":3,"file":"TreeView.lazy-IO6dDLkd.js","sources":["../../website/components/ChildRowDeleteButton.tsx","../../website/routes/TreeView.lazy.tsx"],"sourcesContent":["import { css } from '@linaria/core';\n\nconst childRowActionCrossClassname = css`\n  block-size: 100%;\n  &::before,\n  &::after {\n    content: '';\n    position: absolute;\n    background: grey;\n  }\n\n  &::before {\n    inset-inline-start: 21px;\n    inline-size: 1px;\n    block-size: 100%;\n  }\n\n  &::after {\n    inset-block-start: 50%;\n    inset-inline-start: 21px;\n    block-size: 1px;\n    inline-size: 15px;\n  }\n\n  &:hover {\n    background: red;\n  }\n`;\n\nconst childRowButtonClassname = css`\n  cursor: pointer;\n  position: absolute;\n  inset-inline-start: 21px;\n  transform: translateX(-50%);\n  filter: grayscale(1);\n  &:dir(rtl) {\n    transform: translateX(50%);\n  }\n`;\n\ninterface ChildRowDeleteButtonProps {\n  tabIndex: number;\n  isDeleteSubRowEnabled: boolean;\n  onDeleteSubRow: () => void;\n}\n\nexport function ChildRowDeleteButton({\n  tabIndex,\n  onDeleteSubRow,\n  isDeleteSubRowEnabled\n}: ChildRowDeleteButtonProps) {\n  function handleKeyDown(e: React.KeyboardEvent<HTMLSpanElement>) {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      onDeleteSubRow();\n    }\n  }\n\n  return (\n    <>\n      <div className={childRowActionCrossClassname} />\n      {isDeleteSubRowEnabled && (\n        <div className={childRowButtonClassname} onClick={onDeleteSubRow}>\n          <span tabIndex={tabIndex} onKeyDown={handleKeyDown}>\n            ‚ùå\n          </span>\n        </div>\n      )}\n    </>\n  );\n}\n","import { useMemo, useReducer, useState } from 'react';\nimport { createLazyFileRoute } from '@tanstack/react-router';\nimport { css } from '@linaria/core';\n\nimport DataGrid from '../../src';\nimport type { Column } from '../../src';\nimport { CellExpanderFormatter, ChildRowDeleteButton } from '../components';\nimport { useDirection } from '../directionContext';\n\nexport const Route = createLazyFileRoute('/TreeView')({\n  component: TreeView\n});\n\nconst gridClassname = css`\n  block-size: 600px;\n`;\n\ninterface Row {\n  id: string;\n  name: string;\n  format: string;\n  position: string;\n  price: number;\n  children?: Row[];\n  parentId?: string;\n  isExpanded?: boolean;\n}\n\ninterface Action {\n  type: 'toggleSubRow' | 'deleteSubRow';\n  id: string;\n}\n\nfunction createRows(): Row[] {\n  const rows = [];\n  for (let i = 0; i < 100; i++) {\n    const price = Math.random() * 30;\n    const id = `row${i}`;\n    const row: Row = {\n      id,\n      name: `supplier ${i}`,\n      format: `package ${i}`,\n      position: 'Run of site',\n      price,\n      children: [\n        {\n          id: `${id}-0`,\n          parentId: id,\n          name: `supplier ${i}`,\n          format: '728x90',\n          position: 'run of site',\n          price: price / 2\n        },\n        {\n          id: `${id}-1`,\n          parentId: id,\n          name: `supplier ${i}`,\n          format: '480x600',\n          position: 'run of site',\n          price: price * 0.25\n        },\n        {\n          id: `${id}-2`,\n          parentId: id,\n          name: `supplier ${i}`,\n          format: '328x70',\n          position: 'run of site',\n          price: price * 0.25\n        }\n      ],\n      isExpanded: false\n    };\n    rows.push(row);\n  }\n  return rows;\n}\n\nfunction toggleSubRow(rows: Row[], id: string): Row[] {\n  const rowIndex = rows.findIndex((r) => r.id === id);\n  const row = rows[rowIndex];\n  const { children } = row;\n  if (!children) return rows;\n\n  const newRows = [...rows];\n  newRows[rowIndex] = { ...row, isExpanded: !row.isExpanded };\n  if (row.isExpanded) {\n    newRows.splice(rowIndex + 1, children.length);\n  } else {\n    newRows.splice(rowIndex + 1, 0, ...children);\n  }\n  return newRows;\n}\n\nfunction deleteSubRow(rows: Row[], id: string): Row[] {\n  const row = rows.find((r) => r.id === id);\n  if (row?.parentId === undefined) return rows;\n\n  // Remove sub row from flattened rows.\n  const newRows = rows.filter((r) => r.id !== id);\n\n  // Remove sub row from parent row.\n  const parentRowIndex = newRows.findIndex((r) => r.id === row.parentId);\n  const { children } = newRows[parentRowIndex];\n  if (children) {\n    const newChildren = children.filter((sr) => sr.id !== id);\n    newRows[parentRowIndex] = { ...newRows[parentRowIndex], children: newChildren };\n  }\n\n  return newRows;\n}\n\nfunction reducer(rows: Row[], { type, id }: Action): Row[] {\n  switch (type) {\n    case 'toggleSubRow':\n      return toggleSubRow(rows, id);\n    case 'deleteSubRow':\n      return deleteSubRow(rows, id);\n    default:\n      return rows;\n  }\n}\n\nconst defaultRows = createRows();\n\nfunction TreeView() {\n  const direction = useDirection();\n  const [rows, dispatch] = useReducer(reducer, defaultRows);\n  const [allowDelete, setAllowDelete] = useState(true);\n\n  const columns = useMemo((): readonly Column<Row>[] => {\n    return [\n      {\n        key: 'id',\n        name: 'id',\n        frozen: true\n      },\n      {\n        key: 'name',\n        name: 'Name'\n      },\n      {\n        key: 'format',\n        name: 'format',\n        renderCell({ row, tabIndex }) {\n          const hasChildren = row.children !== undefined;\n          const style = hasChildren ? undefined : { marginInlineStart: 30 };\n          return (\n            <div\n              className={css`\n                display: flex;\n                gap: 10px;\n                block-size: 100%;\n                align-items: center;\n              `}\n            >\n              {hasChildren && (\n                <CellExpanderFormatter\n                  tabIndex={tabIndex}\n                  expanded={row.isExpanded === true}\n                  onCellExpand={() => dispatch({ id: row.id, type: 'toggleSubRow' })}\n                />\n              )}\n              {!hasChildren && (\n                <ChildRowDeleteButton\n                  tabIndex={tabIndex}\n                  isDeleteSubRowEnabled={allowDelete}\n                  onDeleteSubRow={() => dispatch({ id: row.id, type: 'deleteSubRow' })}\n                />\n              )}\n              <div style={style}>{row.format}</div>\n            </div>\n          );\n        }\n      },\n      {\n        key: 'position',\n        name: 'position'\n      },\n      {\n        key: 'price',\n        name: 'price'\n      }\n    ];\n  }, [allowDelete]);\n\n  return (\n    <>\n      <label>\n        Allow Delete\n        <input\n          type=\"checkbox\"\n          checked={allowDelete}\n          onChange={() => setAllowDelete(!allowDelete)}\n        />\n      </label>\n      <DataGrid columns={columns} rows={rows} className={gridClassname} direction={direction} />\n    </>\n  );\n}\n"],"names":["childRowActionCrossClassname","childRowButtonClassname","ChildRowDeleteButton","tabIndex","onDeleteSubRow","isDeleteSubRowEnabled","handleKeyDown","e","key","preventDefault","jsxs","Fragment","children","jsx","className","onClick","onKeyDown","Route","createLazyFileRoute","component","TreeView","gridClassname","createRows","rows","i","price","Math","random","id","row","name","format","position","parentId","isExpanded","push","toggleSubRow","rowIndex","findIndex","r","newRows","splice","length","deleteSubRow","find","filter","parentRowIndex","newChildren","sr","reducer","type","defaultRows","direction","useDirection","dispatch","useReducer","allowDelete","setAllowDelete","useState","columns","useMemo","frozen","renderCell","hasChildren","style","marginInlineStart","CellExpanderFormatter","expanded","onCellExpand","checked","onChange","DataGrid"],"mappings":"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"}